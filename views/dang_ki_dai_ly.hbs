<style>
    .custom-select-wrapper {
        position: relative;
    }

    .custom-arrow {
        position: absolute;
        top: 50%;
        right: 26px;
        transform: translateY(-50%);
        font-size: 16px;
        transition: transform 0.3s ease;
        pointer-events: none;
        z-index: 10;
        background-color: #ffffff;
    }

    .custom-select:focus + .custom-arrow {
        transform: translateY(-50%) rotate(180deg);
    }

    .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1050;
        justify-content: center;
        align-items: center;
    }

    .modal-content {
        max-width: 500px;
        width: 90%;
        background: white; /* Nền trắng */
    }

    .modal-content.success {
        border: 2px solid #28a745; /* Viền xanh cho success */
    }

    .modal-content.error {
        border: 2px solid #dc3545; /* Viền đỏ cho error */
    }

    .btn-close-custom {
        position: absolute;
        top: 10px;
        right: 10px;
    }
</style>

{{#if success_msg}}
<div class="modal-overlay" id="success-popup">
    <div class="modal-content success p-4 rounded-3 shadow">
        <button type="button" class="btn-close btn-close-custom" aria-label="Close" onclick="closePopup('success-popup')"></button>
        <div class="text-center">{{success_msg}}</div>
    </div>
</div>
{{/if}}

{{#if error_msg}}
<div class="modal-overlay" id="error-popup">
    <div class="modal-content error p-4 rounded-3 shadow">
        <button type="button" class="btn-close btn-close-custom" aria-label="Close" onclick="closePopup('error-popup')"></button>
        <div class="text-center">{{error_msg}}</div>
    </div>
</div>
{{/if}}

<div class="container-fluid d-flex flex-column align-items-center" style="width: 100%; height: 100%;margin-top: 32px;">
    <h3 class="mb-5 text-center w-100">
        Đăng ký đại lý
    </h3>
    <form action="/main/dang_ki_dai_ly" method="POST" class="w-100" style="max-width: 600px;">
        
        <!-- Mã đại lý (đưa lên đầu) -->
        <div class="mb-3 row">
            <label for="agencyCode" class="col-sm-3 col-form-label">Mã đại lý</label>
            <div class="col-sm-9">
                <input type="text" class="form-control" id="agencyCode" name="agencyCode" value="{{agencyCode}}" readonly>
            </div>
        </div>

        <!-- Tên đại lý -->
        <div class="mb-3 row">
            <label for="agencyName" class="col-sm-3 col-form-label">Tên đại lý</label>
            <div class="col-sm-9">
                <input type="text" class="form-control" id="agencyName" name="agencyName" placeholder="Nhập tên đại lý" required>
            </div>
        </div>

        <!-- Loại đại lý -->
        <div class="mb-3 row">
            <label for="agencyType" class="col-sm-3 col-form-label">Loại đại lý</label>
            <div class="col-sm-9 custom-select-wrapper">
                <select class="form-select custom-select" id="agencyType" name="agencyType" required>
                    <option value="">-- Chọn loại đại lý --</option>
                    {{#each agencyTypes}}
                        <option value="{{type}}">{{type}}</option>
                    {{/each}}
                </select>
                <span class="custom-arrow">
                    <i class="bi bi-chevron-down"></i>
                </span>
            </div>
        </div>

        <!-- Email -->
        <div class="mb-3 row">
            <label for="email" class="col-sm-3 col-form-label">Email</label>
            <div class="col-sm-9">
                <input type="email" class="form-control" id="email" name="email" placeholder="Nhập email" required>
            </div>
        </div>

        <!-- Điện thoại -->
        <div class="mb-3 row">
            <label for="phoneNumber" class="col-sm-3 col-form-label">Điện thoại</label>
            <div class="col-sm-9">
                <input type="tel" class="form-control" id="phoneNumber" name="phoneNumber" placeholder="Nhập số điện thoại" required>
            </div>
        </div>

        <!-- Quận -->
        <div class="mb-3 row">
            <label for="district" class="col-sm-3 col-form-label">Quận</label>
            <div class="col-sm-9">
                <input type="text" class="form-control" id="district" name="district" placeholder="Nhập quận" required>
            </div>
        </div>

        <!-- Địa chỉ -->
        <div class="mb-3 row">
            <label for="address" class="col-sm-3 col-form-label">Địa chỉ</label>
            <div class="col-sm-9">
                <input type="text" class="form-control" id="address" name="address" placeholder="Nhập địa chỉ" required>
            </div>
        </div>

        <!-- Nút đăng ký -->
        <div class="text-center mt-5">
            <button type="submit" class="btn btn-primary border-0 rounded-5 fw-semibold py-2" 
                style="background-color: #C6BDBD; color: #000; width: 200px;"
                >
                Đăng ký
            </button>
        </div>
    </form>
</div>

<script>
    {{!-- document.addEventListener('DOMContentLoaded', function() {
        const successPopup = document.getElementById('success-popup');
        const errorPopup = document.getElementById('error-popup');

        if (successPopup) {
            successPopup.style.display = 'flex';
        }
        if (errorPopup) {
            errorPopup.style.display = 'flex';
        }
    });

    function closePopup(popupId) {
        const popup = document.getElementById(popupId);
        if (popup) {
            popup.style.display = 'none';
        }
    } --}}
    document.addEventListener("DOMContentLoaded", function () {
        const successPopup = document.getElementById('success-popup');
        const errorPopup = document.getElementById('error-popup');

    if (successPopup) {
      Swal.fire({
        icon: 'success',
        title: 'Thành công',
        text: successPopup.textContent,
        showConfirmButton: false,
        timer: 2000
      }).then(() => {
        window.location.reload(); 
      });
    }

    if (errorPopup) {
      Swal.fire({
        icon: 'error',
        title: 'Lỗi',
        text: errorPopup.textContent,
        showConfirmButton: false,
        timer: 2500
      });
    }
  });
</script>